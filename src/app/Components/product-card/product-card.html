<div class="relative w-full max-w-7xl mx-auto px-4">
    <!-- Carousel Container -->
    @if(allProduct().length > 0) {
        <div class="overflow-hidden">
            <div class="flex gap-5 transition-transform duration-500 ease-in-out"
                [style.transform]="'translateX(-' + (currentIndex * (100 / itemsPerView)) + '%)'">

                @for(card of allProduct(); track card.id) {
                <div class="flex-shrink-0" [style.width]="'calc((100% / ' + itemsPerView + ') - 1.25rem)'">
                    <!-- Card -->
                    <div class="bg-[#1C252E] rounded-2xl flex flex-col gap-3 items-start px-6 py-4 h-full">

                        <!-- Image div -  -->
                        <div class="w-full h-48 overflow-hidden rounded-2xl">
                            <a [routerLink]="['/product-details', card.id]" class="block h-full">
                                <img [src]="card.images?.[0]"  
                                     [alt]="card.title" 
                                     class="w-full h-full object-cover hover:scale-105 transition-transform duration-300">
                            </a>
                        </div>

                        <!-- Text -->
                        <div class="flex justify-between w-full items-start">
                            <p class="text-white font-bold text-sm flex-1 pr-2 line-clamp-1">{{card.title}}</p>
                            <p class="text-[#258CF4] font-semibold text-sm whitespace-nowrap">${{card.price}}</p>
                        </div>

                        <!-- Description - -->
                        <div class="w-full">
                            <a [routerLink]="['/product-details', card.id]" 
                               class="text-[#9BAAB9] text-sm line-clamp-2 hover:text-[#b8c5d3] transition-colors cursor-pointer block">
                                {{card.description}}
                            </a>
                        </div>

                        <!-- Button -->
                        <div class="w-full mt-auto">
                            <button
                                class="bg-[#283039] text-white w-full py-2 rounded-lg cursor-pointer hover:bg-[#323d47] transition-colors text-sm font-medium">
                                <i class="fa-solid fa-cart-plus"></i> Quick Add
                            </button>
                        </div>
                    </div>
                </div>
                }
            </div>
        </div>

        <!-- Previous Button -->
        <button (click)="prev()" [disabled]="!canGoPrev" [class.opacity-50]="!canGoPrev"
            [class.cursor-not-allowed]="!canGoPrev"
            class="absolute top-1/2 left-0 -translate-y-1/2 z-30 flex items-center justify-center w-10 h-10 rounded-full bg-white/30 hover:bg-white/50 focus:outline-none focus:ring-4 focus:ring-white transition-all disabled:cursor-not-allowed">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
        </button>

        <!-- Next Button -->
        <button (click)="next()" [disabled]="!canGoNext" [class.opacity-50]="!canGoNext"
            [class.cursor-not-allowed]="!canGoNext"
            class="absolute top-1/2 right-0 -translate-y-1/2 z-30 flex items-center justify-center w-10 h-10 rounded-full bg-white/30 hover:bg-white/50 focus:outline-none focus:ring-4 focus:ring-white transition-all disabled:cursor-not-allowed">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
        </button>

        <!-- Indicators -->
        @if(totalDots > 0) {
            <div class="flex justify-center gap-2 mt-4">
                @for(dot of Array(totalDots); track $index) {
                <button (click)="goToSlide($index)" 
                    [class.bg-blue-500]="currentIndex === $index"
                    [class.bg-gray-400]="currentIndex !== $index" 
                    class="w-3 h-3 rounded-full transition-colors">
                </button>
                }
            </div>
        }
    } @else {
        <div class="text-white text-center py-10">
            <p>Loading products...</p>
        </div>
    }
</div>